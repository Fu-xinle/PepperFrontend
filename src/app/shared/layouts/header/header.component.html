<div class="main-header">
  <div class="logo">
    <img src="./assets/images/logo.png" alt="" />
  </div>

  <div class="menu-toggle" (click)="toggelSidebar()">
    <div></div>
    <div></div>
    <div></div>
  </div>

  <div class="d-flex align-items-center">
    <!-- Mega menu -->
    <div ngbDropdown class="mega-menu d-none d-md-block">
      <button ngbDropdownToggle href="#" class="btn text-muted dropdown-toggle me-3">Mega Menu</button>
      <div ngbDropdownMenu [perfectScrollbar]="{ suppressScrollX: false }">
        <div class="row m-0">
          <div class="col-md-4 p-4 bg-img">
            <h2 class="title">
              Mega Menu <br />
              Sidebar
            </h2>
            <p>你未看此花时,此花与汝心同归与寂;你来看此花时,则此花颜色一时明白起来,便知此花不在你的心外.</p>
            <p class="mb-4">
              少年听雨歌楼上,红烛昏罗帐.壮年听雨客舟中,江阔云低,断雁叫西风.而今听雨僧庐下,鬓已星星也.悲欢离合总无情,一任阶前点滴到天明.
            </p>
            <!-- <p class="mb-4">
              古今之成大事业、大学问者,必经过三种之境界:"昨夜西风凋碧树,独上高楼,望尽天涯路",此第一境也."衣带渐宽终不悔,为伊消得人憔悴",此第二境也."众里寻他千百度,蓦然回首,那人却在,灯火阑珊处",此第三境也.
            </p> -->
            <button class="btn btn-lg btn-rounded btn-outline-warning">Learn More</button>
          </div>
          <div class="col-md-4 p-4">
            <p class="text-primary text--cap border-bottom-primary d-inline-block">Features</p>
            <div class="menu-icon-grid w-auto p-0">
              <a href="#"><i class="icon-Checked-User"></i> 账户</a>
              <a href="#"><i class="icon-File-ClipboardFileText"></i> 日志</a>
              <a href="#"><i class="icon-File-Word"></i> 文档</a>
              <a href="#"><i class="icon-Computer-2"></i> 软件</a>
              <a href="#"><i class="icon-Data-Center"></i> 数据库</a>
              <a href="#"><i class="icon-Old-Telephone"></i> 技术支持</a>
            </div>
          </div>
          <div class="col-md-4 p-4">
            <p class="text-primary text--cap border-bottom-primary d-inline-block">Components</p>
            <ul class="links">
              <li><a href="accordion.html">Accordion</a></li>
              <li><a href="alerts.html">Alerts</a></li>
              <li><a href="buttons.html">Buttons</a></li>
              <li><a href="badges.html">Badges</a></li>
              <li><a href="carousel.html">Carousels</a></li>
              <li><a href="lists.html">Lists</a></li>
              <li><a href="popover.html">Popover</a></li>
              <li><a href="tables.html">Tables</a></li>
              <li><a href="datatables.html">Datatables</a></li>
              <li><a href="modals.html">Modals</a></li>
              <li><a href="nouislider.html">Sliders</a></li>
              <li><a href="tabs.html">Tabs</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <!-- Search bar -->
    <div class="search-bar">
      <input type="text" placeholder="搜索" (focus)="searchService.searchOpen = true" />
      <i class="search-icon cursor-pointer text-muted icon-Magnifi-Glass2" (click)="searchService.searchOpen = true"></i>
    </div>
  </div>

  <div style="margin: auto"></div>

  <div class="header-part-right">
    <i appScreenFull class="icon-Full-Screen header-icon d-none d-sm-inline-block" role="button"></i>
    <div ngbDropdown [placement]="'bottom-right'" class="d-none d-sm-inline-block">
      <i ngbDropdownToggle class="icon-Gear text-muted header-icon" role="button"></i>
      <div ngbDropdownMenu class="menu-icon-grid-dropdown">
        <div class="menu-icon-grid">
          <a href="#"><i class="icon-Checked-User"></i> 账户</a>
          <a href="#"><i class="icon-File-ClipboardFileText"></i> 日志</a>
          <a href="#"><i class="icon-File-Word"></i> 文档</a>
          <a href="#"><i class="icon-Computer-2"></i> 软件</a>
          <a href="#"><i class="icon-Data-Center"></i> 数据库</a>
          <a href="#"><i class="icon-Old-Telephone"></i> 技术支持</a>
        </div>
      </div>
    </div>

    <div ngbDropdown [placement]="'bottom-right'">
      <div class="badge-top-container">
        <span class="badge bg-primary">{{ notifications.length }}</span>
        <i ngbDropdownToggle class="icon-Bell text-muted header-icon" role="button"></i>
      </div>
      <div ngbDropdownMenu class="notification-dropdown rtl-ps-none" [perfectScrollbar]="{ suppressScrollX: false }">
        <div class="dropdown-item d-flex" *ngFor="let item of notifications" [routerLink]="[item.link]">
          <div class="notification-icon">
            <i class="{{ item.icon }} text-{{ item.status }} me-1"></i>
          </div>
          <div class="notification-details flex-grow-1">
            <p class="m-0 d-flex align-items-center">
              <span>{{ item.title }}</span>
              <span *ngIf="item.badge" class="badge rounded-pill bg-{{ item.status }} ms-1 me-1">{{ item.badge }}</span>
              <span class="flex-grow-1"></span>
              <span class="text-small text-muted ms-auto">{{ item.time | relativeTime }}</span>
            </p>
            <p class="text-small text-muted m-0">
              {{ item.text | excerpt: 30 }}
            </p>
          </div>
        </div>
      </div>
    </div>

    <div ngbDropdown [placement]="'bottom-right'" class="user col align-self-end ps-4">
      <img [src]="domSanitizerService.bypassSecurityTrustUrl(userInfo.photo)" class="cursor-pointer" ngbDropdownToggle alt="" />

      <div ngbDropdownMenu aria-labelledby="userDropdown" class="header-account-dropdown">
        <div class="dropdown-header"><i class="icon-Lock-User me-1"></i> {{ userInfo.userName }}</div>
        <button class="dropdown-item" (click)="userInformation()">账户信息</button>
        <button class="dropdown-item" (click)="changePassword(modalChangePassword)">重置密码</button>
        <button class="dropdown-item" (click)="signout()">注销</button>
      </div>
    </div>
  </div>
</div>

<ng-template #modalChangePassword let-modal>
  <div class="modal-header">
    <h5 class="modal-title" id="modal-title">重置密码</h5>
    <button type="button" class="btn-close" aria-label="关闭按钮" aria-describedby="标题" (click)="modal.dismiss('Cross click')"> </button>
  </div>
  <div class="modal-body">
    <form [formGroup]="changePasswordForm" class="ms-4 me-4">
      <div class="mb-2">
        <label for="newPassword" class="form-label">新密码</label>
        <input
          id="newPassword"
          class="form-control form-control-rounded"
          [ngClass]="{ 'value-invalid': changePasswordNotification.newPasswordMessageShow }"
          formControlName="newPassword"
          type="password"
        />
        <p *ngIf="changePasswordNotification.newPasswordMessageShow" class="pt-1 mb-0">
          <span class="text-danger">{{ changePasswordNotification.newPasswordMessage }}</span>
        </p>
      </div>
      <div class="mb-2">
        <label for="confirmNewPassword" class="form-label">确认密码</label>
        <input
          id="confirmNewPassword"
          class="form-control form-control-rounded"
          [ngClass]="{ 'value-invalid': changePasswordNotification.confirmNewPasswordMessageShow }"
          formControlName="confirmNewPassword"
          type="password"
        />
        <p *ngIf="changePasswordNotification.confirmNewPasswordMessageShow" class="pt-1 mb-0">
          <span class="text-danger">{{ changePasswordNotification.confirmNewPasswordMessage }}</span>
        </p>
      </div>
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-outline-secondary btn-rounded" (click)="modal.dismiss('cancel')">取 消</button>
    <app-btn-loading
      [btnClass]="'btn-primary btn-rounded'"
      (click)="onSubmit(changePasswordForm.value)"
      [type]="'button'"
      [loadingText]="loadingText"
      [loading]="loading"
    >
      确 认
    </app-btn-loading>
  </div>
</ng-template>
